#!/usr/bin/env bash

git_do(){ git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME "$@"; }

commit(){ git_do commit -am "$changes"; }

push(){ git_do push; }

get_status(){
   commit_status=$(git_do commit --status --porcelain)
   changes=$(git_do status --porcelain)
}

print_status(){
   [[ ! -z $commit_status ]] &&
      printf '%s\n' "committed: $commit_status"
   [[ ! -z $changes ]] &&
      printf '%s\n' "uncommitted: $changes"
}

up(){
   [[ $changes ]] && commit
   push
}

case_opts(){
   case $1 in
      up) up ;;
      status) print_status ;;
      *) git_do "$@"
   esac
}

main(){
   get_status
   case_opts "$@"
}

main "$@"
