#!/usr/bin/env bash

git_do(){
   git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME "$@"
}

up(){
   [[ $changes ]] && commit; push
}

commit(){
   git_do commit -am "$changes"
}

push(){
   git_do push
}

print_status(){
   changes=$(git_do status --porcelain)
   [[ -z "$1" && ! -z $changes ]] && printf '%s\n' "$changes"
}

case_opts(){
   case $1 in up) up ;; *) git_do "$@"; esac
}

main(){
   [[ $1 ]] || exit
   case_opts "$@"
}

print_status "$1"
main "$@"
